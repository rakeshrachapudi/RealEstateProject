-- Update users table (remove OTP fields, add role field)
ALTER TABLE users 
ADD COLUMN role VARCHAR(20) DEFAULT 'USER' NOT NULL,
ADD COLUMN is_active BOOLEAN DEFAULT true NOT NULL,
ADD COLUMN created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
ADD COLUMN updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
DROP COLUMN IF EXISTS otp,
DROP COLUMN IF EXISTS otp_expiry_time,
DROP COLUMN IF EXISTS mobile_number;

-- Add unique constraints
ALTER TABLE users 
ADD UNIQUE INDEX idx_username (username),
ADD UNIQUE INDEX idx_email (email);